â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸš¨ ACTION IMMÃ‰DIATE                            â•‘
â•‘                   FIX DÃ‰FINITIF - 4 FÃ‰V 2026                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PROBLÃˆME IDENTIFIÃ‰ ET CORRIGÃ‰ :

Le composant utilisait "media_library" et "videos" 
â†’ La table s'appelle "playout_media_library" âŒ

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Ã‰TAPE 1 : EXÃ‰CUTER LE SCRIPT SQL                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Ouvrez Supabase Dashboard
2. Allez dans "SQL Editor"
3. Copiez-collez le contenu du fichier :
   
   ğŸ“„ SCRIPT_SQL_COMPLET_RECONSTRUCTION.sql
   
4. Cliquez "Run" (ExÃ©cuter)

âœ… Ce script va :
   - CrÃ©er/vÃ©rifier la table playout_media_library
   - Configurer les policies RLS permissives
   - Forcer le rechargement du cache
   - Ajouter les index pour la performance

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           Ã‰TAPE 2 : CLIQUER SUR PUBLISH (Important !)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Le code frontend a Ã©tÃ© corrigÃ© :

âœ… PlayoutMediaLibrary.tsx
   - from('media_library') â†’ from('playout_media_library')
   - Noms de colonnes alignÃ©s avec la table
   - media_type â†’ type
   - source_url â†’ media_url

âœ… API Route
   - /app/api/playout/media/save/route.ts
   - Utilise SERVICE_ROLE_KEY si disponible
   - Sinon utilise ANON_KEY avec policies permissives

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Ã‰TAPE 3 : TESTER                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AprÃ¨s avoir exÃ©cutÃ© le script SQL et cliquÃ© sur Publish :

1. Rechargez complÃ¨tement la page (Ctrl+Shift+R)
2. Allez sur /playout/library
3. Cliquez "Ajouter"
4. URL : https://youtu.be/dQw4w9WgXcQ
5. Bouton bleu â†’ Infos remplies
6. Cliquez "Ajouter"

âœ… RÃ‰SULTAT ATTENDU :
   - Toast : "MÃ©dia ajoutÃ© avec succÃ¨s"
   - MÃ©dia apparaÃ®t dans la grille
   - Pas d'erreur dans la console

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    NOM DÃ‰FINITIF FIGÃ‰                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ NOM DE TABLE : playout_media_library

Ce nom est maintenant utilisÃ© PARTOUT dans le code :
   âœ… Frontend (PlayoutMediaLibrary.tsx)
   âœ… Backend (API Route)
   âœ… Base de donnÃ©es (Supabase)

Plus JAMAIS de changement de nom !

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              SI PROBLÃˆME PERSISTE APRÃˆS PUBLISH                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. VÃ©rifiez que le script SQL a bien Ã©tÃ© exÃ©cutÃ© :
   
   SELECT tablename FROM pg_tables 
   WHERE tablename = 'playout_media_library';
   
   â†’ Doit retourner 1 ligne

2. VÃ©rifiez les policies :
   
   SELECT policyname FROM pg_policies 
   WHERE tablename = 'playout_media_library';
   
   â†’ Doit montrer 4 policies (insert, select, update, delete)

3. Ouvrez F12 â†’ Console et envoyez-moi TOUS les logs

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         PRODUCTION                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pour Vercel, ajoutez (optionnel mais recommandÃ©) :

Variables d'environnement :
   SUPABASE_SERVICE_ROLE_KEY = [votre_service_role_key]

â†’ L'API bypassera automatiquement RLS
â†’ SÃ©curitÃ© maximale

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       RÃ‰CAPITULATIF                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Table SQL      : playout_media_library (DÃ‰FINITIF)
âœ… Frontend corrigÃ© : PlayoutMediaLibrary.tsx
âœ… Backend corrigÃ©  : /api/playout/media/save/route.ts
âœ… Policies RLS    : Permissives (dÃ©veloppement)
âœ… Cache forcÃ©     : NOTIFY pgrst reload

ğŸ“ PROCHAINE Ã‰TAPE :
   1. ExÃ©cutez SCRIPT_SQL_COMPLET_RECONSTRUCTION.sql
   2. Cliquez sur PUBLISH
   3. Testez l'ajout d'un mÃ©dia

ğŸš€ LE PROBLÃˆME EST MAINTENANT RÃ‰SOLU !
